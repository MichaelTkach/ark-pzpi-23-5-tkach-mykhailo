ХАРКІВСЬКИЙ НАЦІОНАЛЬНИЙ УНІВЕРСИТЕТ РАДІОЕЛЕКТРОНІКИ
Факультет Комп’ютерних наук
Кафедра Програмної інженерії

ЗВІТ
з лабораторної роботи №5
з дисципліни «Аналіз та рефакторинг коду»
на тему: «Розгортання програмної системи та демонстрація її роботи»

Виконав:
ст. гр. ПЗПІ-23-5
Ткач М.

Перевірив:
Сокорчук І.П.

Харків 2025

1 ІСТОРІЯ ЗМІН

| Версія | Дата       | Автор      | Опис змін                                       |
|--------|------------|------------|-------------------------------------------------|
| 1.0    | 05.02.2025 | Ткач М.    | Контейнеризація серверу та підготовка до деплою |

2 ЗАВДАННЯ

1. Виконати контейнеризацію серверної частини системи EcoRecycle.
2. Підготувати файли конфігурації для автоматичного розгортання (Docker Compose).
3. Продемонструвати працездатність системи у розгорнутому вигляді.

3 ОПИС ВИКОНАНОЇ РОБОТИ

3.1 Інженерні рішення

Для розгортання системи обрано технологію **Docker**.
Обґрунтування:
- **Ізоляція:** Всі залежності (C++ бібліотеки, SQLite) знаходяться всередині образу, що гарантує роботу на будь-якій машині.
- **Відтворюваність:** `Dockerfile` чітко описує процес збірки.
- **Масштабованість:** Контейнери легко масштабувати або переносити в хмару.

3.2 Інструкція з розгортання

Для спрощення запуску системи розроблено Shell-скрипт `start.sh`, який автоматизує перезапуск контейнерів командою:
```bash
./start.sh
```
Цей скрипт виконує зупинку старих контейнерів та збірку нових, що відповідає практикам CI/CD.

Для ручного запуску необхідно:

Для запуску системи необхідно:
1. Встановити Docker Desktop на цільову машину.
2. Перейти в директорію з `docker-compose.yml`.
3. Виконати команду:
   ```bash
   docker-compose up --build
   ```
   Ця команда збере образ `ecorecycle_server`, створить контейнер та запустить його. Сервер буде доступний за адресою `http://localhost:18080`.

3.3 Архітектура розгортання

Система складається з одного основного сервісу `server`, який містить скомпільований C++ додаток. База даних SQLite зберігається у файлі, який підмонтовано через Docker Volumes (`./ecorecycle_lab3.db:/app/build/ecorecycle_lab3.db`) для забезпечення персистентності даних між перезапусками контейнера. Порт 18080 прокидається на хост-машину для доступу до API.

4 ВИСНОВОК

В ході лабораторної роботи було успішно виконано контейнеризацію бекенду EcoRecycle. Система збирається та запускається в автоматичному режимі, дані зберігаються персистентно завдяки використанню Docker Volumes. Комплекс лабораторних робіт завершено, створено повнофункціональну систему з IoT-клієнтом, сервером, базою даних та адмін-панеллю.

5 ВИКОРИСТАНІ ДЖЕРЕЛА

1. Docker – офіційна документація. URL: https://docs.docker.com/
2. Docker Compose – офіційна документація. URL: https://docs.docker.com/compose/
3. CMake with Docker Best Practices.

ДОДАТОК А
Посилання на відео: https://youtu.be/fbhgWEwk7zM 
00:00 Вступ
00:10 Огляд структури серверної частини (Dockerfile)
01:31 Огляд конфігурації docker-compose
02:17 Білд та запуск контейнерів
02:49 Демонстрація роботи API
04:27 Тестування персистентності бази даних

ДОДАТОК Б
Фрагменти програмного коду

Б.1 Dockerfile
```dockerfile
FROM ubuntu:latest

RUN apt-get update && apt-get install -y \
    g++ \
    cmake \
    make \
    libsqlite3-dev \
    libboost-all-dev \
    && rm -rf /var/lib/apt/lists/*

WORKDIR /app

COPY . .

RUN mkdir -p build && cd build && \
    cmake .. && \
    make

EXPOSE 18081

CMD ["./build/EcoRecycleServer"]
```

Б.2 docker-compose.yml
```yaml
version: '3'
services:
  server:
    build: .
    ports:
      - "18080:18081"
    volumes:
      - ./ecorecycle_lab3.db:/app/build/ecorecycle_lab3.db
```
