ХАРКІВСЬКИЙ НАЦІОНАЛЬНИЙ УНІВЕРСИТЕТ РАДІОЕЛЕКТРОНІКИ
Факультет Комп’ютерних наук
Кафедра Програмної інженерії

ЗВІТ
з лабораторної роботи №2
з дисципліни «Аналіз та рефакторинг коду»
на тему: «Проектування та розробка серверної частини»

Виконав:
ст. гр. ПЗПІ-23-5
Ткач М.

Перевірив:
Сокорчук І.П.

Харків 2025

1 ІСТОРІЯ ЗМІН

| Версія | Дата       | Автор      | Опис змін                                       |
|--------|------------|------------|-------------------------------------------------|
| 1.0    | 05.02.2025 | Ткач М.    | Розробка архітектури БД та реалізація API на C++|

2 ЗАВДАННЯ

1. Розробити спроектувати структуру бази даних для системи EcoRecycle.
2. Розробити серверну частину (REST API) з використанням мови C++.
3. Реалізувати механізм реєстрації, отримання списку пунктів та фіксації здачі сміття.

3 ОПИС ВИКОНАНОЇ РОБОТИ

3.1 Інженерні рішення

Для реалізації серверної частини було обрано мову програмування **C++**.
Причини вибору:
- **Висока продуктивність:** C++ забезпечує мінімальний оверхед при обробці запитів, що важливо для високонавантажених систем.
- **Енергоефективність:** Оскільки проєкт має "зелену" спрямованість, використання компільованої мови знижує споживання ресурсів процесора порівняно з інтерпретованими мовами, що зменшує вуглецевий слід дата-центрів.
- **Контроль пам'яті:** Можливість тонкого налаштування використання ресурсів.

Технологічний стек:
- **Crow:** Швидкий C++ мікрофреймворк для створення веб-сервісів (натхненний Python Flask).
- **SQLite3:** Вбудована реляційна база даних, що не потребує окремого сервера, ідеальна для прототипування та вбудованих рішень.
- **CMake:** Кросплатформна система автоматизації збірки.

3.2 Проєктування Бази Даних

Розроблено ER-модель, що складається з таких сутностей:
1. **users**: Зберігає дані користувачів (email, password_hash, role, balance).
2. **waste_categories**: Категорії відходів (Plastic, Glass) та їх ціна.
3. **recycling_points**: Інформація про пункти прийому (адреса, координати).
4. **transactions**: Журнал здачі сміття (хто, що, скільки, коли).

3.3 Специфікація API

| Метод | URL                | Опис                                      | Тіло запиту (JSON) | Відповідь |
|-------|--------------------|-------------------------------------------|--------------------|-----------|
| POST  | /api/auth/register | Реєстрація нового користувача             | {"email": "...", "password": "..."} | 201 Created |
| GET   | /api/points        | Отримати список пунктів прийому           | - | 200 OK (JSON array) |
| POST  | /api/recycle       | Зафіксувати здачу сміття та нарахувати бали| {"user_id": 1, "waste_id": 1, "weight": 2.5} | 200 OK |

3.4 Реалізація

Реалізовано клас `Database` з використанням патерна Singleton для забезпечення єдиного з'єднання з базою даних.

Фрагмент коду (Database Connection):
```cpp
bool Database::init(const std::string& dbPath) {
    if (sqlite3_open(dbPath.c_str(), &db)) {
        std::cerr << "Error opening database: " << sqlite3_errmsg(db) << std::endl;
        return false;
    }
    // ... створення таблиць ...
    return true;
}
```

Фрагмент коду (Обробка API запиту в `main.cpp`):
```cpp
CROW_ROUTE(app, "/api/recycle").methods(crow::HTTPMethod::POST)([](const crow::request& req){
    auto x = crow::json::load(req.body);
    if (!x) return crow::response(400);
    int userId = x["user_id"].i();
    // ... логіка транзакції ...
});
```

4 ВИСНОВКИ

В результаті виконання лабораторної роботи було спроектовано та реалізовано високопродуктивний backend-сервер системи EcoRecycle мовою C++. Використання Crow та SQLite дозволило створити легке та швидке рішення, що відповідає вимогам до сучасних веб-додатків. Реалізовано базові CRUD операції необхідні для функціонування MVP.

5 ВИКОРИСТАНІ ДЖЕРЕЛА

1. Crow C++ Framework Documentation. URL: https://crowcpp.org/
2. SQLite C Interface Documentation. URL: https://www.sqlite.org/cintro.html
3. ISO/IEC 14882:2017 Programming Loop C++.

ДОДАТОК А
Демонстраційний відеоматеріал

Посилання на відео: https://youtu.be/PLACEHOLDER_LAB2 (Очікується запис згідно сценарію)

На відео продемонстровано:
1. Компіляція серверу за допомогою CMake.
2. Запуск виконавчого файлу `./server`.
3. Ініціалізація бази даних та створення таблиць.
4. Тестування API ендпоінтів за допомогою curl: успішна реєстрація, отримання списку пунктів, створення транзакції.

ДОДАТОК Б
Графічні матеріали

(Місце для ER-діаграми та діаграми класів, що описують структуру `models.h`)
